<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title></title>
	<link rel="stylesheet" type="text/css" href="css/reset.css" />
	<link rel="stylesheet" type="text/css" href="css/header.css" />
	<link rel="stylesheet" type="text/css" href="css/shopping-cart.css" />
</head>


<body>
	<!--头部灰色部分-->
	<div class="topBack" id="topBack">
		<div class="container clearfix">
			<ul class="topList clearfix fr">
				<li class="fl">
					<a href="login.html">登陆</a>
					<s>&nbsp;</s>
					<a href="suer center.html">我的丽子</a>
				</li>
				<li class="fl source re">
					<a href="">关注我们
						<img class="up_pic tran" src="images/down.png" alt=""></a>
					<div class="microblog ab tran">
						<div class="microblog_box">
							<img class="weiBo" src="images/weibo.png" alt="">
							<span>扫描二维码</span>
							<p>关注丽子美妆微信</p>
							<img class="saoMa" src="images/saoma.png" alt="">
						</div>
					</div>
				</li>
				<li class="fl">
					<a href="">帮助中心</a>
				</li>
				<li class="fl">
					<a href="">
						<img src="images/heart.png" alt=""> 收藏粒子
					</a>
				</li>
			</ul>
		</div>
	</div>
	<div class="shopping-cart">
		<!--标题-->
		<div class="title">
			<div class="container">
				<div class="logo fl">
					<a href="index.html"><img src="images/logo-lizi.png" /></a>
					<span>购物车</span>
				</div>
				<!--流程图-->
				<div class="process fr">
				</div>
				<div class="clear">
				</div>
			</div>
		</div>
		<!--全部商品 优惠商品 库存紧张-->
		<div class="container">
			<div class="classify">
				<ul class="clearfix">
					<li class="fl">
						<a href="#">全部商品（5）</a>
					</li>
					<li class="fl">
						<a href="#">优惠商品（0）</a>
					</li>
					<li class="fl">
						<a href="#">库存紧张（0)</a>
					</li>
				</ul>
			</div>
			<!--表单-->
			<div class="all-goods">
				<!--第一行-->
				<div class="lists">
					<ul class="clearfix">
						<li class="select fl">
							<span class="both-select check"></span>
							<span class="">全选</span>
						</li>
						<li class="item fl"><span>商品</span></li>
						<li class="message fl"><span>商品信息</span></li>
						<li class="price fl"><span>单价</span></li>
						<li class="num fl"><span>数量</span></li>
						<li class="sum fl"><span>小计</span></li>
						<li class="operation fl"><span>操作</span></li>
					</ul>
				</div>
				<!--安妮珍选-->
				<div class="annie an">
					<span class="check shop_check"></span>
					<a href="#"><span class="word">安妮珍选</span></a>
					<a href="#"><img src="images/shop_service.gif" /></a>

					<!--安妮商品-->
					<div class="annie-goods">
						<ul class="clearfix">
							<li class="photo fl">
								<span class="check"></span>
								<a href="#"><img src="images/1d4649cbbbe09.jpg" /></a>
								<a href="#"><span class="goods-word">HABA润泽柔肤水G水G露180ml补水保湿爽肤水化妆水孕妇可用无添加</span></a>
							</li>
							<li class="size-word fl">
								<span class="size">规格：HABA润泽柔肤水180ml</span>
							</li>
							<li class="piece fl"><span>￥<i>251.00</i></span></li>
							<li class="num fl">
								<span>-</span>
								<input type="text" name="" id="" value="1" />
								<span>+</span>
							</li>
							<li class="sum fl">
								<span>￥<i>251.00</i></span>
							</li>
							<li class="delect fl">
								<a href="#"><span class="del">删除</span></a>
							</li>
						</ul>
					</div>
				</div>
				<!--丽子自营-->
				<div class="annie lizi">
					<span class="check shop_check"></span>
					<a href="#"><span class="word">丽子自营</span></a>
					<a href="#"><img src="images/shop_service.gif" /></a>
					<!--丽子自营商品-->
					<!--柔肤水-->
					<div class="annie-goods ">
						<ul class="clearfix">
							<li class="photo fl">
								<span class="check"></span>
								<a href="#"><img src="images/11def6b1ced4f.jpg" /></a>
								<a href="#"><span class="goods-word">日本Freeplus芙丽芳丝控油修护化妆水130ml</span></a>
							</li>
							<li class="size-word fl">
								<span class="size"></span>
							</li>
							<li class="piece fl">
								<p></p>
								<span>￥<i>260.00</i></span>
							</li>
							<li class="num fl">
								<span>-</span>
								<input type="text" name="" id="" value="1" />
								<span>+</span>
							</li>
							<li class="sum fl">
								<span>￥<i>260.00</i></span>
							</li>
							<li class="delect fl">
								<a href="#"><span class="del">删除</span></a>
							</li>
						</ul>
					</div>

					<div class="annie-goods">
						<ul class="clearfix">
							<li class="photo fl">
								<span class="check"></span>
								<a href="#"><img src="images/1d4649cbbbe09.jpg" /></a>
								<a href="#"><span class="goods-word">HABA润泽柔肤水G水G露180ml补水保湿爽肤水化妆水孕妇可用无添加</span></a>
							</li>
							<li class="size-word fl">
								<span class="size">规格：HABA润泽柔肤水180ml</span>
							</li>
							<li class="piece fl"><span>￥<i>312.00</i></span></li>
							<li class="num fl">
								<span>-</span>
								<input type="text" name="" id="" value="1" />
								<span>+</span>
							</li>
							<li class="sum fl">
								<span>￥<i>312.00</i></span>
							</li>
							<li class="delect fl">
								<a href="#"><span class="del">删除</span></a>
							</li>
						</ul>
					</div>
					<div class="annie-goods">
						<ul class="clearfix">
							<li class="photo fl">
								<span class="check"></span>
								<a href="#"><img src="images/1d4649cbbbe09.jpg" /></a>
								<a href="#"><span class="goods-word">HABA润泽柔肤水G水G露180ml补水保湿爽肤水化妆水孕妇可用无添加</span></a>
							</li>
							<li class="size-word fl">
								<span class="size">规格：HABA润泽柔肤水180ml</span>
							</li>
							<li class="piece fl"><span>￥<i>621.00</i></span></li>
							<li class="num fl">
								<span>-</span>
								<input type="text" name="" id="" value="1" />
								<span>+</span>
							</li>
							<li class="sum fl">
								<span>￥<i>621.00</i></span>
							</li>
							<li class="delect fl">
								<a href="#"><span class="del">删除</span></a>
							</li>
						</ul>
					</div>
					<div class="annie-goods">
						<ul class="clearfix">
							<li class="photo fl">
								<span class="check "></span>
								<a href="#"><img src="images/1d4649cbbbe09.jpg" /></a>
								<a href="#"><span class="goods-word">HABA润泽柔肤水G水G露180ml补水保湿爽肤水化妆水孕妇可用无添加</span></a>
							</li>
							<li class="size-word fl">
								<span class="size">规格：HABA润泽柔肤水180ml</span>
							</li>
							<li class="piece fl"><span>￥<i>120.00</i></span></li>
							<li class="num fl">
								<span>-</span>
								<input type="text" name="" id="" value="1" />
								<span>+</span>
							</li>
							<li class="sum fl">
								<span>￥<i>120.00</i></span>
							</li>
							<li class="delect fl">
								<a href="#"><span class="del">删除</span></a>
							</li>
						</ul>
					</div>
				</div>
			</div>

			<!--结算-->
			<div class="account">
				<div class="all-select fl">
					<ul class="clearfix">
						<li class="pad fl"><span class="both-select check"></span></li>
						<li class="pad all fl"><span>全选</span></li>
						<li class="pad all fl">
							<a href="#"><span class="all_del">删除</span></a>
						</li>
						<li class="pad fl">
							<a href="#"><span>清空失效商品</span></a>
						</li>
						<li class="fr">总计：<span class="pr-red">￥<i>0.00</i></span></li>
					</ul>
				</div>
				
				<div class="total fr">
					去结算
				</div>
				
				<div class="clear">
				</div>
			</div>

		</div>
	</div>
	<script src="js/jquery-1.12.4.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">


		$(document).ready(function () {
			var sumCheck = 0;
			var sumP1 = 0;
			var sumP2 = 0;
			// var sumP3=0;
			var price = $('.pr-red').find('i').text();
			var sum = parseInt($('.sum').find('i').text());


			// 选中
			var flag = true;
			var array = [];
			var arr = [];
			var fin = 0;
			var aarr = [];
			var number=0;
			var snumber=0;
			// 全选
			$(".both-select").click(function () {
				if (flag) {
					$('.check').addClass('add_price');
					for (var i = 0; i < ($('.add_price').parent('.photo').siblings('.sum').find('i')).length; i++) {
						sumP1 = sumP1 + parseInt($($('.add_price').parent('.photo').siblings('.sum').find('i')[i]).text());
					}

					flag = false;
				} else {
					$('.check').removeClass('add_price');
					for (var i = 0; i < ($('.check').parent('.photo').siblings('.sum').find('i')).length; i++) {
						sumP1 = sumP1 - (parseInt($($('.check').parent('.photo').siblings('.sum').find('i')[i]).text()));
					}
					flag = true;
				}
				$('.pr-red').find('i').text(sumP1 + '.00');
				red();

			})
			// 部分选择
			array.push($('.shop_check'));

			for (var i = 0; i < $('.shop_check').length; i++) {
				$(array[0][i]).click(function () {
					// 判断列表全选的条件：表头框是否有背景图
					if ($(this).hasClass('add_price')) {
						// 有/移除												
						$(this).parent('.annie').find('.add_price').removeClass('add_price');

						// 循环遍历价格进行算法

						for (var i = 0; i < $(this).siblings('.annie-goods').find('.sum').find('i').length; i++) {
							sumP1 = sumP1 - (parseInt($($(this).siblings('.annie-goods').find('.sum').find('i')[i]).text()));
						}
					}
					else {
						// 无/增加背景图
						$(this).parent('.annie').find('.check').addClass('add_price');
						// 循环遍历价格进行算法
						for (var i = 0; i < $(this).siblings('.annie-goods').find('.sum').find('i').length; i++) {
							// fin=parseInt($('.pr-red').find('i').text());
							sumP1 = sumP1 + (parseInt($($(this).siblings('.annie-goods').find('.sum').find('i')[i]).text()));
						}

					}
				
					// sumP2=sumP2+sumP1;
					$('.pr-red').find('i').text(sumP1 + '.00');
					red();
				})
			}
			console.log($(this).siblings('.cc'));

			// 部分单个选择
			arr.push($('.annie-goods .check'));
			for (var i = 0; i < arr[0].length; i++) {
				$(arr[0][i]).click(function () {
					if ($(this).hasClass('add_price')) {
						// sumP1=0;
						
						$(this).removeClass('add_price');
						// 移除列表全选的背景图
						$($(this).parents('.annie-goods').siblings('.shop_check')[0]).removeClass('add_price');
						fin = parseInt($('.pr-red').find('i').text());
						sumP1 = fin - (parseInt($(this).parent('.photo').siblings('.sum').find('i').text()));
					} else {
						//新添背景图
						$(this).addClass('add_price');
						sumP1 = sumP1 + (parseInt($(this).parent('.photo').siblings('.sum').find('i').text()));
					}
					// 输出
					$('.pr-red').find('i').text(sumP1 + '.00');
					// 结账
					red();
					fin = parseInt($('.pr-red').find('i').text());
					console.log(fin);
					//
					

					//
				})
			}
			$('.num span:nth-child(3)').click(function () {
				var num = parseInt($(this).siblings('input').val());
				$(this).siblings('input').val(num + 1);
				var price1 = parseFloat($(this).parent('.num').siblings('.piece').find('i').text());
				var sum = parseFloat($(this).parent('.num').siblings('.sum').find('i').text());
				$(this).parent('.num').siblings('.sum').find('i').text(sum + price1 + '.00');
				if ($(this).parent('.num').siblings('.photo').find('span').hasClass('add_price')) {
					fin = parseInt($('.pr-red').find('i').text());
					$('.pr-red').find('i').text(fin + price1 + '.00');
				}
				console.log(fin)
			})
			$('.num span:first-child()').click(function () {
				var num = parseInt($(this).siblings('input').val());
				if (num == 1) {
					alert('物品数量不能小于1');
					return false;
				}
				$(this).siblings('input').val(num - 1);
				var price1 = parseFloat($(this).parent('.num').siblings('.piece').find('i').text());
				var sum = parseFloat($(this).parent('.num').siblings('.sum').find('i').text());
				$(this).parent('.num').siblings('.sum').find('i').text(sum - price1 + '.00');
				if ($(this).parent('.num').siblings('.photo').find('span').hasClass('add_price')) {
					fin = parseInt($('.pr-red').find('i').text());
					$('.pr-red').find('i').text(fin - price1 + '.00');
				}
			})


			//删除
			// 勾选上的不能删除
			$('.del').click(function () {
				if($(this).parents('.delect').siblings('.photo').find('span').hasClass('add_price')){
					return false;
				}
				else{
					if ($(this).parents('.annie-goods').siblings('div').hasClass('annie-goods')) {
					$(this).parents('.annie-goods').remove();
				}
				else {
					$(this).parents('.annie').remove();
				}
				}
				
			})

			//全部删除
			$('.all_del').click(function () {
				$(this).parents('.account').siblings('.all-goods').find('.annie').remove();
				$('.pr-red').find('i').text('0.00');
			})
			//
			function red(){
				fin = parseInt($('.pr-red').find('i').text());
					if (fin != 0) {
						$('.total').css({
							backgroundColor: 'red',
							cursor: 'pointer'
						})
					}
					else{
						$('.total').css({
							backgroundColor: '#ddd',
							cursor: 'auto'
						})
					}
			}
			$('.total').click(function(){
				window.location.href='order.html'
			})
			





		})






	</script>
</body>

</html>